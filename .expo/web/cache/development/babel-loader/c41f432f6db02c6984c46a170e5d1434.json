{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/thadz/Desktop/SunSavings/fixedProfileAndTransfer/pnmobileapp/src/screens/EditProfile/EditProfileContainer.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { connect } from \"react-redux\";\nimport validate from \"validate.js\";\nimport { EditProfile } from \"./EditProfile\";\nimport { config } from \"./config\";\nimport { profile as profileAPI } from \"../../API\";\nexport var EditProfileContainer = function EditProfileContainer(props) {\n  var _attributes$name, _attributes$name2, _attributes$name3, _attributes$name4, _attributes$name5, _attributes$name6;\n\n  var auth = props.auth,\n      attributes = props.profile.attributes,\n      user = props.user,\n      navigation = props.navigation,\n      params = props.route.params;\n\n  var _useState = useState({\n    firstName: (attributes == null ? void 0 : (_attributes$name = attributes.name) == null ? void 0 : _attributes$name.firstName) ? attributes == null ? void 0 : (_attributes$name2 = attributes.name) == null ? void 0 : _attributes$name2.firstName : user.info.firstName,\n    middleName: (attributes == null ? void 0 : (_attributes$name3 = attributes.name) == null ? void 0 : _attributes$name3.middleName) ? attributes == null ? void 0 : (_attributes$name4 = attributes.name) == null ? void 0 : _attributes$name4.middleName : user.info.middleName,\n    lastName: (attributes == null ? void 0 : (_attributes$name5 = attributes.name) == null ? void 0 : _attributes$name5.lastName) ? attributes == null ? void 0 : (_attributes$name6 = attributes.name) == null ? void 0 : _attributes$name6.lastName : user.info.lastName\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      formData = _useState2[0],\n      setFormData = _useState2[1];\n\n  var _useState3 = useState({}),\n      _useState4 = _slicedToArray(_useState3, 2),\n      invalids = _useState4[0],\n      setInvalids = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      isSubmitting = _useState6[0],\n      setSubmittingStatus = _useState6[1];\n\n  useEffect(function () {\n    if (params == null ? void 0 : params.formData) {\n      setFormData(function (currentState) {\n        return _objectSpread(_objectSpread({}, currentState), params == null ? void 0 : params.formData);\n      });\n    }\n  }, [params == null ? void 0 : params.formData]);\n\n  var handleBlur = function handleBlur(index) {\n    var additionalValidation = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    if (!config.validate) {\n      return true;\n    }\n\n    var newInvalids = {};\n\n    if (__DEV__) {\n      if (!formData[index] === undefined) {\n        console.warn(\"'\" + index + \"' index is not found in [formData] state.\");\n      }\n\n      if (!config.constraints[index]) {\n        console.warn(\"There are no Validation Constraints for '\" + index + \"' form data index.\");\n      }\n    }\n\n    var toBeValidated = _objectSpread(_objectSpread({}, additionalValidation), {}, _defineProperty({}, index, formData[index]));\n\n    var invalid = handleValidate(toBeValidated, _defineProperty({}, index, config.constraints[index]));\n\n    if (!invalid) {\n      newInvalids = _objectSpread({}, invalids);\n      delete newInvalids[index];\n    } else {\n      newInvalids = _objectSpread(_objectSpread({}, invalids), invalid);\n    }\n\n    setInvalids(newInvalids);\n    return newInvalids;\n  };\n\n  var handleChange = function handleChange(index, value) {\n    setFormData(function (currentState) {\n      return _objectSpread(_objectSpread({}, currentState), {}, _defineProperty({}, index, value));\n    });\n  };\n\n  var handleSubmit = function handleSubmit() {\n    var invalid = handleValidate(formData, config.constraints);\n\n    if (invalid) {\n      setInvalids(invalid);\n    } else {\n      handleSaveProfile();\n    }\n  };\n\n  var handleSaveProfile = function handleSaveProfile() {\n    setSubmittingStatus(true);\n    profileAPI.addAttribute({\n      accessToken: auth.accessToken,\n      attributeName: \"name\",\n      attributeValue: formData\n    }).then(function (_ref) {\n      var _ref$data = _ref.data,\n          success = _ref$data.success,\n          message = _ref$data.message;\n\n      if (success) {\n        Alert.alert(\"Edit Profile\", \"Your profile was successfully updated\", [{\n          text: \"Ok\",\n          onPress: function onPress() {\n            return navigation.navigate(\"ViewProfile\", {\n              reload: true\n            });\n          }\n        }]);\n      } else {\n        Alert.alert(\"Edit Profile\", \"Failed while updating profile.\", [{\n          text: \"Retry\",\n          onPress: function onPress() {\n            return handleSaveProfile();\n          }\n        }, {\n          text: \"Cancel\",\n          style: \"cancel\"\n        }]);\n      }\n    }).catch(function (error) {\n      Alert.alert(\"Server Error\", \"Ooops! There's something wrong connecting to the server. Please try again.\");\n    }).finally(function () {\n      return setSubmittingStatus(false);\n    });\n  };\n\n  var handleValidate = function handleValidate() {\n    var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var constraints = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    if (!config.validate) {\n      return false;\n    }\n\n    var invalid = validate(data, constraints);\n    return invalid;\n  };\n\n  return React.createElement(EditProfile, {\n    data: formData,\n    invalids: invalids,\n    isSubmitting: isSubmitting,\n    onBlur: handleBlur,\n    onChange: handleChange,\n    onSubmit: handleSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 5\n    }\n  });\n};\nEditProfileContainer.propTypes = {};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return function () {\n    return {\n      auth: state.auth,\n      user: state.user,\n      profile: state.profile\n    };\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {};\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(EditProfileContainer);","map":{"version":3,"sources":["/Users/thadz/Desktop/SunSavings/fixedProfileAndTransfer/pnmobileapp/src/screens/EditProfile/EditProfileContainer.js"],"names":["React","useEffect","useState","PropTypes","connect","validate","EditProfile","config","profile","profileAPI","EditProfileContainer","props","auth","attributes","user","navigation","params","route","firstName","name","info","middleName","lastName","formData","setFormData","invalids","setInvalids","isSubmitting","setSubmittingStatus","currentState","handleBlur","index","additionalValidation","newInvalids","__DEV__","undefined","console","warn","constraints","toBeValidated","invalid","handleValidate","handleChange","value","handleSubmit","handleSaveProfile","addAttribute","accessToken","attributeName","attributeValue","then","data","success","message","Alert","alert","text","onPress","navigate","reload","style","catch","error","finally","propTypes","mapStateToProps","state","mapDispatchToProps","dispatch"],"mappings":";;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,OAAOC,SAAP,MAAsB,YAAtB;;AAEA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAOC,QAAP,MAAqB,aAArB;AAGA,SAASC,WAAT;AAKA,SAASC,MAAT;AACA,SAASC,OAAO,IAAIC,UAApB;AAEA,OAAO,IAAMC,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACC,KAAD,EAAW;AAAA;;AAAA,MAE3CC,IAF2C,GASzCD,KATyC,CAE3CC,IAF2C;AAAA,MAIzCC,UAJyC,GASzCF,KATyC,CAG3CH,OAH2C,CAIzCK,UAJyC;AAAA,MAM3CC,IAN2C,GASzCH,KATyC,CAM3CG,IAN2C;AAAA,MAO3CC,UAP2C,GASzCJ,KATyC,CAO3CI,UAP2C;AAAA,MAQlCC,MARkC,GASzCL,KATyC,CAQ3CM,KAR2C,CAQlCD,MARkC;;AAAA,kBAUbd,QAAQ,CAAC;AACvCgB,IAAAA,SAAS,EAAE,CAAAL,UAAU,QAAV,gCAAAA,UAAU,CAAEM,IAAZ,sCAAkBD,SAAlB,IAA8BL,UAA9B,yCAA8BA,UAAU,CAAEM,IAA1C,qBAA8B,kBAAkBD,SAAhD,GAA4DJ,IAAI,CAACM,IAAL,CAAUF,SAD1C;AAEvCG,IAAAA,UAAU,EAAE,CAAAR,UAAU,QAAV,iCAAAA,UAAU,CAAEM,IAAZ,uCAAkBE,UAAlB,IAA+BR,UAA/B,yCAA+BA,UAAU,CAAEM,IAA3C,qBAA+B,kBAAkBE,UAAjD,GAA8DP,IAAI,CAACM,IAAL,CAAUC,UAF7C;AAGvCC,IAAAA,QAAQ,EAAE,CAAAT,UAAU,QAAV,iCAAAA,UAAU,CAAEM,IAAZ,uCAAkBG,QAAlB,IAA6BT,UAA7B,yCAA6BA,UAAU,CAAEM,IAAzC,qBAA6B,kBAAkBG,QAA/C,GAA0DR,IAAI,CAACM,IAAL,CAAUE;AAHvC,GAAD,CAVK;AAAA;AAAA,MAUtCC,QAVsC;AAAA,MAU5BC,WAV4B;;AAAA,mBAebtB,QAAQ,CAAC,EAAD,CAfK;AAAA;AAAA,MAetCuB,QAfsC;AAAA,MAe5BC,WAf4B;;AAAA,mBAgBDxB,QAAQ,CAAC,KAAD,CAhBP;AAAA;AAAA,MAgBtCyB,YAhBsC;AAAA,MAgBxBC,mBAhBwB;;AAkB7C3B,EAAAA,SAAS,CAAC,YAAM;AACd,QAAIe,MAAJ,oBAAIA,MAAM,CAAEO,QAAZ,EAAsB;AACpBC,MAAAA,WAAW,CAAC,UAACK,YAAD;AAAA,+CACPA,YADO,GAEPb,MAFO,oBAEPA,MAAM,CAAEO,QAFD;AAAA,OAAD,CAAX;AAID;AACF,GAPQ,EAON,CAACP,MAAD,oBAACA,MAAM,CAAEO,QAAT,CAPM,CAAT;;AAeA,MAAMO,UAAU,GAAG,SAAbA,UAAa,CAACC,KAAD,EAAsC;AAAA,QAA9BC,oBAA8B,uEAAP,EAAO;;AACvD,QAAI,CAACzB,MAAM,CAACF,QAAZ,EAAsB;AACpB,aAAO,IAAP;AACD;;AAED,QAAI4B,WAAW,GAAG,EAAlB;;AAEA,QAAIC,OAAJ,EAAa;AAEX,UAAI,CAACX,QAAQ,CAACQ,KAAD,CAAT,KAAqBI,SAAzB,EAAoC;AAClCC,QAAAA,OAAO,CAACC,IAAR,OAAiBN,KAAjB;AACD;;AAGD,UAAI,CAACxB,MAAM,CAAC+B,WAAP,CAAmBP,KAAnB,CAAL,EAAgC;AAC9BK,QAAAA,OAAO,CAACC,IAAR,+CAC8CN,KAD9C;AAGD;AACF;;AAED,QAAMQ,aAAa,mCACdP,oBADc,2BAEhBD,KAFgB,EAERR,QAAQ,CAACQ,KAAD,CAFA,EAAnB;;AAKA,QAAMS,OAAO,GAAGC,cAAc,CAACF,aAAD,sBAC3BR,KAD2B,EACnBxB,MAAM,CAAC+B,WAAP,CAAmBP,KAAnB,CADmB,EAA9B;;AAIA,QAAI,CAACS,OAAL,EAAc;AAEZP,MAAAA,WAAW,qBAAQR,QAAR,CAAX;AACA,aAAOQ,WAAW,CAACF,KAAD,CAAlB;AACD,KAJD,MAIO;AAELE,MAAAA,WAAW,mCACNR,QADM,GAENe,OAFM,CAAX;AAID;;AAGDd,IAAAA,WAAW,CAACO,WAAD,CAAX;AAGA,WAAOA,WAAP;AACD,GA/CD;;AAiDA,MAAMS,YAAY,GAAG,SAAfA,YAAe,CAACX,KAAD,EAAQY,KAAR,EAAkB;AACrCnB,IAAAA,WAAW,CAAC,UAACK,YAAD;AAAA,6CACPA,YADO,2BAETE,KAFS,EAEDY,KAFC;AAAA,KAAD,CAAX;AAID,GALD;;AAOA,MAAMC,YAAY,GAAG,SAAfA,YAAe,GAAM;AAEzB,QAAMJ,OAAO,GAAGC,cAAc,CAAClB,QAAD,EAAWhB,MAAM,CAAC+B,WAAlB,CAA9B;;AACA,QAAIE,OAAJ,EAAa;AACXd,MAAAA,WAAW,CAACc,OAAD,CAAX;AACD,KAFD,MAEO;AACLK,MAAAA,iBAAiB;AAClB;AACF,GARD;;AAUA,MAAMA,iBAAiB,GAAG,SAApBA,iBAAoB,GAAM;AAC9BjB,IAAAA,mBAAmB,CAAC,IAAD,CAAnB;AAEAnB,IAAAA,UAAU,CACPqC,YADH,CACgB;AACZC,MAAAA,WAAW,EAAEnC,IAAI,CAACmC,WADN;AAEZC,MAAAA,aAAa,EAAE,MAFH;AAGZC,MAAAA,cAAc,EAAE1B;AAHJ,KADhB,EAMG2B,IANH,CAMQ,gBAAoC;AAAA,2BAAjCC,IAAiC;AAAA,UAAzBC,OAAyB,aAAzBA,OAAyB;AAAA,UAAhBC,OAAgB,aAAhBA,OAAgB;;AACxC,UAAID,OAAJ,EAAa;AACXE,QAAAA,KAAK,CAACC,KAAN,CAAY,cAAZ,EAA4B,uCAA5B,EAAqE,CACnE;AACEC,UAAAA,IAAI,EAAE,IADR;AAEEC,UAAAA,OAAO,EAAE;AAAA,mBAAM1C,UAAU,CAAC2C,QAAX,CAAoB,aAApB,EAAmC;AAAEC,cAAAA,MAAM,EAAE;AAAV,aAAnC,CAAN;AAAA;AAFX,SADmE,CAArE;AAMD,OAPD,MAOO;AACLL,QAAAA,KAAK,CAACC,KAAN,CAAY,cAAZ,EAA4B,gCAA5B,EAA8D,CAC5D;AACEC,UAAAA,IAAI,EAAE,OADR;AAEEC,UAAAA,OAAO,EAAE;AAAA,mBAAMZ,iBAAiB,EAAvB;AAAA;AAFX,SAD4D,EAK5D;AACEW,UAAAA,IAAI,EAAE,QADR;AAEEI,UAAAA,KAAK,EAAE;AAFT,SAL4D,CAA9D;AAUD;AACF,KA1BH,EA2BGC,KA3BH,CA2BS,UAACC,KAAD,EAAW;AAChBR,MAAAA,KAAK,CAACC,KAAN,CACE,cADF,EAEE,4EAFF;AAID,KAhCH,EAiCGQ,OAjCH,CAiCW;AAAA,aAAMnC,mBAAmB,CAAC,KAAD,CAAzB;AAAA,KAjCX;AAkCD,GArCD;;AAuCA,MAAMa,cAAc,GAAG,SAAjBA,cAAiB,GAAiC;AAAA,QAAhCU,IAAgC,uEAAzB,EAAyB;AAAA,QAArBb,WAAqB,uEAAP,EAAO;;AACtD,QAAI,CAAC/B,MAAM,CAACF,QAAZ,EAAsB;AACpB,aAAO,KAAP;AACD;;AAED,QAAMmC,OAAO,GAAGnC,QAAQ,CAAC8C,IAAD,EAAOb,WAAP,CAAxB;AAEA,WAAOE,OAAP;AACD,GARD;;AAUA,SACE,oBAAC,WAAD;AACE,IAAA,IAAI,EAAEjB,QADR;AAEE,IAAA,QAAQ,EAAEE,QAFZ;AAGE,IAAA,YAAY,EAAEE,YAHhB;AAIE,IAAA,MAAM,EAAEG,UAJV;AAKE,IAAA,QAAQ,EAAEY,YALZ;AAME,IAAA,QAAQ,EAAEE,YANZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF;AAUD,CA9JM;AAgKPlC,oBAAoB,CAACsD,SAArB,GAAiC,EAAjC;;AAEA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAACC,KAAD;AAAA,SAAW,YAAM;AACvC,WAAO;AACLtD,MAAAA,IAAI,EAAEsD,KAAK,CAACtD,IADP;AAELE,MAAAA,IAAI,EAAEoD,KAAK,CAACpD,IAFP;AAGLN,MAAAA,OAAO,EAAE0D,KAAK,CAAC1D;AAHV,KAAP;AAKD,GANuB;AAAA,CAAxB;;AAQA,IAAM2D,kBAAkB,GAAG,SAArBA,kBAAqB,CAACC,QAAD,EAAc;AACvC,SAAO,EAAP;AACD,CAFD;;AAIA,eAAehE,OAAO,CACpB6D,eADoB,EAEpBE,kBAFoB,CAAP,CAGbzD,oBAHa,CAAf","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Alert } from \"react-native\";\nimport { connect } from \"react-redux\";\nimport validate from \"validate.js\";\n\n// Form Component\nimport { EditProfile } from \"./EditProfile\";\n\n// Custom Component Here\n\n// Others\nimport { config } from \"./config\";\nimport { profile as profileAPI } from \"../../API\";\n\nexport const EditProfileContainer = (props) => {\n  const {\n    auth,\n    profile: {\n      attributes,\n    },\n    user,\n    navigation,\n    route: { params },\n  } = props;\n  const [formData, setFormData] = useState({\n    firstName: attributes?.name?.firstName ? attributes?.name?.firstName : user.info.firstName,\n    middleName: attributes?.name?.middleName ? attributes?.name?.middleName : user.info.middleName,\n    lastName: attributes?.name?.lastName ? attributes?.name?.lastName : user.info.lastName,\n  });\n  const [invalids, setInvalids] = useState({});\n  const [isSubmitting, setSubmittingStatus] = useState(false);\n\n  useEffect(() => {\n    if (params?.formData) {\n      setFormData((currentState) => ({\n        ...currentState,\n        ...params?.formData,\n      }));\n    }\n  }, [params?.formData]);\n\n  /**\n   * Handle Blur Event Listener\n   * @description Used for validating inputs when onBlur event is triggered\n   * @param {String} index formData index\n   * @param {Object} additionalValidation Additional data for validation (used for Equality Validation)\n   */\n  const handleBlur = (index, additionalValidation = {}) => {\n    if (!config.validate) {\n      return true;\n    }\n\n    let newInvalids = {};\n\n    if (__DEV__) {\n      // Warn the user if the given index doesn't exist in [formData] state\n      if (!formData[index] === undefined) {\n        console.warn(`'${index}' index is not found in [formData] state.`);\n      }\n\n      // Warn the user if there's no Validation Constraints to the specified index\n      if (!config.constraints[index]) {\n        console.warn(\n          `There are no Validation Constraints for '${index}' form data index.`\n        );\n      }\n    }\n\n    const toBeValidated = {\n      ...additionalValidation,\n      [index]: formData[index],\n    };\n\n    const invalid = handleValidate(toBeValidated, {\n      [index]: config.constraints[index],\n    });\n\n    if (!invalid) {\n      // Remove the specified index from [invalids] state\n      newInvalids = { ...invalids };\n      delete newInvalids[index];\n    } else {\n      // Add [invalid] to [invalids] state\n      newInvalids = {\n        ...invalids,\n        ...invalid,\n      };\n    }\n\n    // Set new Invalids as [invalids] state\n    setInvalids(newInvalids);\n\n    // Return New Invalids\n    return newInvalids;\n  };\n\n  const handleChange = (index, value) => {\n    setFormData((currentState) => ({\n      ...currentState,\n      [index]: value,\n    }));\n  };\n\n  const handleSubmit = () => {\n    // Validate\n    const invalid = handleValidate(formData, config.constraints);\n    if (invalid) {\n      setInvalids(invalid);\n    } else {\n      handleSaveProfile();\n    }\n  };\n\n  const handleSaveProfile = () => {\n    setSubmittingStatus(true);\n    // Submit\n    profileAPI\n      .addAttribute({\n        accessToken: auth.accessToken,\n        attributeName: \"name\",\n        attributeValue: formData,\n      })\n      .then(({ data: { success, message } }) => {\n        if (success) {\n          Alert.alert(\"Edit Profile\", \"Your profile was successfully updated\", [\n            {\n              text: \"Ok\",\n              onPress: () => navigation.navigate(\"ViewProfile\", { reload: true }),\n            },\n          ]);\n        } else {\n          Alert.alert(\"Edit Profile\", \"Failed while updating profile.\", [\n            {\n              text: \"Retry\",\n              onPress: () => handleSaveProfile(),\n            },\n            {\n              text: \"Cancel\",\n              style: \"cancel\",\n            },\n          ]);\n        }\n      })\n      .catch((error) => {\n        Alert.alert(\n          \"Server Error\",\n          \"Ooops! There's something wrong connecting to the server. Please try again.\"\n        );\n      })\n      .finally(() => setSubmittingStatus(false));\n  };\n\n  const handleValidate = (data = {}, constraints = {}) => {\n    if (!config.validate) {\n      return false;\n    }\n\n    const invalid = validate(data, constraints);\n    // Do additional invalid data processing here\n    return invalid;\n  };\n\n  return (\n    <EditProfile\n      data={formData}\n      invalids={invalids}\n      isSubmitting={isSubmitting}\n      onBlur={handleBlur}\n      onChange={handleChange}\n      onSubmit={handleSubmit}\n    />\n  );\n};\n\nEditProfileContainer.propTypes = {};\n\nconst mapStateToProps = (state) => () => {\n  return {\n    auth: state.auth,\n    user: state.user,\n    profile: state.profile,\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {};\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(EditProfileContainer);\n"]},"metadata":{},"sourceType":"module"}